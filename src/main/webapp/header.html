<script src="js/jquery-3.3.1.js"></script>
<script src="js/getParameter.js"></script>
<script>
    //发送异步请求，获取登录的用户信息
    $.post("user/isLogin", function (result) {
        var data = result.data;

        if (data == null) {
            //未登录
            $(".shortcut").append("<!-- 未登录状态  -->\n" +
                "            <div class=\"login_out\">\n" +
                "                <a href=\"login.html\">登录</a>\n" +
                "                <a href=\"register.html\">注册</a>\n" +
                "            </div>")
        } else {
            //已登录
            $(".shortcut").append("<!-- 登录状态  -->\n" +
                "            <div class=\"login\">\n" +
                "            \t\n" +
                "                <span>欢迎回来，" + data.name + "</span>\n" +
                "                <a href=\"myfavorite.html?currentPage=1\" class=\"collection\">我的收藏</a>\n" +
                "                <a href=\"user/loginOut\">退出</a>\n" +
                "            </div>")
        }
    }, "json");


    //获取所有的内容分类，从SQL数据库获取
    $.post("category/findAllCategory", function (result) {
        var data = result.data;
        var flag = result.flag;
        //从redis中获取的字符串数据转换成json对象数组的形式
        data = eval("(" + data + ")");
        if (flag) {
            $.each(data, function (index, element) {
                var cname = element.cname;
                var cid = element.cid;
                $(".nav").append("<li><a href=\"route_list.html?cid=" + cid + "&currentPage=1\">" + cname + "</a></li>")
            });
            //最后添加收藏排行榜
            $(".nav").append("<li><a href=\"favoriterank.html?currentPage=1\">收藏排行榜</a></li>")
        }
    }, "json");

    function searchRoute() {
        //获取请求的url地址中cid以及currentPage
        var cid = getParameter("cid");
        var currentPage = getParameter("currentPage");

        //获取搜索条件
        var keyword = $("#keyword").val();

        //跳转到route_list.html页面
        location.href = "route_list.html?cid=" + cid + "&currentPage=" + currentPage + "&keyword=" + keyword;
    }

</script>
<!-- 头部 start -->
<header id="header">
    <div class="top_banner">
        <img src="images/top_banner.jpg" alt="">
    </div>
    <div class="shortcut">


    </div>
    <div class="header_wrap">
        <div class="topbar">
            <div class="logo">
                <a href="/"><img src="images/logo.jpg" alt=""></a>
            </div>
            <div class="search">
                <input name="keyword" type="text" id="keyword" placeholder="请输入路线名称" class="search_input" autocomplete="off">
                <a href="javascript:;" onclick="searchRoute()" class="search-button">搜索</a>
            </div>
            <div class="hottel">
                <div class="hot_pic">
                    <img src="images/hot_tel.jpg" alt="">
                </div>
                <div class="hot_tel">
                    <p class="hot_time">客服热线(9:00-6:00)</p>
                    <p class="hot_num">400-618-9090</p>
                </div>
            </div>
        </div>
    </div>
</header>
<!-- 头部 end -->
<!-- 首页导航 -->
<div class="navitem">
    <ul class="nav">
        <li class="nav-active"><a href="index.html">首页</a></li>
        <!--<li>
        <a href="route_list.html">门票</a></li>
        <li><a href="route_list.html">酒店</a></li>
        <li><a href="route_list.html">香港车票</a></li>
        <li><a href="route_list.html">出境游</a></li>
        <li><a href="route_list.html">国内游</a></li>
        <li><a href="route_list.html">港澳游</a></li>
        <li><a href="route_list.html">抱团定制</a></li>
        <li><a href="route_list.html">全球自由行</a></li>
        <li><a href="favoriterank.html">收藏排行榜</a></li>
        -->
    </ul>
</div>
    